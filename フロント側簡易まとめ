ğŸ§© å…¨ä½“æ§‹æˆã¾ã¨ã‚ï¼ˆDRF + Vue 3 + Vuetify + Piniaï¼‰
â–  ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆfrontend/ï¼‰

æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

Vue.js 3ï¼ˆComposition APIï¼‰

Vuetify

Piniaï¼ˆçŠ¶æ…‹ç®¡ç†ï¼‰

Vue Router

Axiosï¼ˆCSRFå¯¾å¿œã‚ã‚Šï¼‰

i18nï¼ˆå¤šè¨€èªå¯¾å¿œï¼‰

ãƒ‡ã‚¶ã‚¤ãƒ³æŒ‡é‡ãƒ»æ¨©é™ãƒ»ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãªã©ã‚’ composable ã§å…±é€šåŒ–



*******************************************************************************

1. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å½¹å‰²
ConfirmDialog.vue - ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°

<!-- ä½¿ç”¨ä¾‹ -->
<ConfirmDialog
    v-model="showDialog"
    title="å‰Šé™¤ç¢ºèª"
    message="æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ"
    confirm-text="å‰Šé™¤"
    cancel-text="ã‚­ãƒ£ãƒ³ã‚»ãƒ«"
    confirm-color="error"
    icon="alert-circle"
    :loading="isDeleting"
    @confirm="handleDelete"
    @cancel="handleCancel"
>
    <!-- ã‚ªãƒ—ã‚·ãƒ§ãƒ³: è¿½åŠ æƒ…å ± -->
    <template #content>
        <p class="text-caption text-grey">ã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“</p>
    </template>
</ConfirmDialog>

*******************************************************************************
Header.vue - ãƒ˜ãƒƒãƒ€ãƒ¼ï¼‹ãƒ‘ãƒ³ããš

<!-- ä½¿ç”¨ä¾‹ -->
<Header
    app-title="ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ "
    :breadcrumbs="[
        { title: 'ãƒ›ãƒ¼ãƒ ', to: '/' },
        { title: 'ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†', to: '/users', disabled: true }
    ]"
    :page-buttons="[
        { name: 'æ–°è¦ä½œæˆ', icon: 'add', type: 'primary', action: handleCreate },
        { name: 'ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ', icon: 'download', type: 'success', action: handleExport }
    ]"
/>

*******************************************************************************
MenuCard.vue - ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚«ãƒ¼ãƒ‰ï¼ˆå˜ä½“ï¼‰

<!-- ä½¿ç”¨ä¾‹ -->
<MenuCard
    icon="admin_panel_settings"
    title="ç®¡ç†"
    to="/admin"
    color="primary"
    :icon-size="64"
/>

*******************************************************************************
MenuCardGrid.vue - ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚«ãƒ¼ãƒ‰ã®ã‚°ãƒªãƒƒãƒ‰è¡¨ç¤º

<script setup>
const menuItems = [
    { icon: 'dashboard', title: 'ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰', to: '/dashboard', color: 'primary' },
    { icon: 'person', title: 'ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«', to: '/profile', color: 'success' },
    { icon: 'settings', title: 'è¨­å®š', to: '/settings', color: 'info' }
];
</script>

<template>
    <MenuCardGrid :items="menuItems" />
</template>

*******************************************************************************
NavBar.vue - ãƒˆãƒƒãƒ—ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼

ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼ˆãƒ¬ãƒ¼ãƒ«åˆ‡ã‚Šæ›¿ãˆï¼‰
ãƒ–ãƒ©ãƒ³ãƒ‰ãƒ­ã‚´ï¼‹ã‚¿ã‚¤ãƒˆãƒ«
ãƒ¦ãƒ¼ã‚¶ãƒ¼åè¡¨ç¤º
ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãƒœã‚¿ãƒ³

*******************************************************************************
SideBar.vue - ã‚µã‚¤ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³

ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ï¼ˆãƒ›ãƒ¼ãƒ ã€ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã€ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãªã©ï¼‰
æ¨©é™ã«å¿œã˜ãŸãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼ˆisAdminã§ç®¡ç†ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨ç¤ºï¼‰
è¨€èªåˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ï¼ˆä¸‹éƒ¨å›ºå®šï¼‰

*******************************************************************************
Notification.vue - ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥
// stores/notification.js ã§ä½¿ç”¨
notification.success('ä¿å­˜ã—ã¾ã—ãŸ');
notification.error('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
notification.warning('æ³¨æ„ã—ã¦ãã ã•ã„');
notification.info('ãŠçŸ¥ã‚‰ã›ã§ã™');


*******************************************************************************
2. Composablesï¼ˆå†åˆ©ç”¨å¯èƒ½ãªãƒ­ã‚¸ãƒƒã‚¯ï¼‰
useDesignSystem.js - ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†

const { colors, getIcon, getSize, getSpacing, toggleTheme } = useDesignSystem();

// ä½¿ç”¨ä¾‹
const iconSize = getSize('md'); // 24
const primaryColor = colors.value.current.primary;
const homeIcon = getIcon('nav', 'home'); // 'home'

*******************************************************************************
usePermissions.js - æ¨©é™ç®¡ç†

const { isAdmin, isActive } = usePermissions();

// ä½¿ç”¨ä¾‹
<v-btn v-if="isAdmin">ç®¡ç†ãƒ¡ãƒ‹ãƒ¥ãƒ¼</v-btn>

*******************************************************************************
useValidation.js - ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«

const { rules, createRules } = useValidation();

// ä½¿ç”¨ä¾‹
const employeeIdRules = createRules.loginUseremployeeId();
const passwordRules = createRules.loginPassword();

*******************************************************************************
3. Constantsï¼ˆå®šæ•°ç®¡ç†ï¼‰

icons.js - ã‚¢ã‚¤ã‚³ãƒ³çµ±ä¸€ç®¡ç†

import { ICONS } from '@/constants/icons';

// ä½¿ç”¨ä¾‹
<v-icon>{{ ICONS.nav.home }}</v-icon>
<v-icon>{{ ICONS.action.add }}</v-icon>
<v-icon>{{ ICONS.status.success }}</v-icon>

*******************************************************************************
theme.js - ãƒ†ãƒ¼ãƒãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³çµ±ä¸€

import { COLORS, SPACING } from '@/constants/theme';

// ä½¿ç”¨ä¾‹
const primaryColor = COLORS.brand.primary; // '#1976D2'
const padding = SPACING.lg; // 24

*******************************************************************************
messages.js - ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸çµ±ä¸€

import { messages } from '@/constants/messages';

// ä½¿ç”¨ä¾‹ï¼ˆãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ï¼‰
const errorMsg = messages.required.replace('{name}', messages.fields.employeeId);
// â†’ "ç¤¾å“¡ç•ªå·ã¯å¿…é ˆã§ã™"


********************************************************************************

1. ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°é–¢é€£
routes.js - ãƒ«ãƒ¼ãƒˆå®šç¾©ã®çµ±ä¸€ç®¡ç†

import { routes } from '@/constants/routes';

// ä½¿ç”¨ä¾‹: ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
router.push(routes.USER_DETAIL.replace(':id', userId));
router.push(routes.HOME);

// ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ã®ä½¿ç”¨
<v-btn :to="routes.USERS">ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§</v-btn>

ãƒ¡ãƒªãƒƒãƒˆ: ã‚¿ã‚¤ãƒé˜²æ­¢ã€ä¸€æ‹¬å¤‰æ›´ãŒå®¹æ˜“

*******************************************************************************
2. APIå±¤
auth.js - èªè¨¼API

import { authAPI } from '@/api/auth';

// ä½¿ç”¨ä¾‹
await authAPI.getCsrf();
await authAPI.login('12345', 'password');
await authAPI.logout();
const user = await authAPI.me();

*******************************************************************************
users.js - ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†API

import { usersAPI } from '@/api/users';

// ä½¿ç”¨ä¾‹
const users = await usersAPI.list({ page: 1, search: 'test' });
const user = await usersAPI.get(userId);
await usersAPI.create({ username: 'new_user', ... });
await usersAPI.update(userId, { username: 'updated' });
await usersAPI.delete(userId);
const stats = await usersAPI.stats();

*******************************************************************************
3. Axiosè¨­å®š
axios.js - è‡ªå‹•CSRFãƒ»èªè¨¼ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

// è‡ªå‹•çš„ã«å‡¦ç†ã•ã‚Œã‚‹å†…å®¹:
// 1. CSRFãƒˆãƒ¼ã‚¯ãƒ³ã®è‡ªå‹•å–å¾—ãƒ»ä»˜ä¸ï¼ˆPOST/PUT/PATCH/DELETEæ™‚ï¼‰
// 2. 401/403ã‚¨ãƒ©ãƒ¼æ™‚ã®è‡ªå‹•ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
// 3. CSRFã‚¨ãƒ©ãƒ¼æ™‚ã®è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤

// ä½¿ç”¨ä¾‹ï¼ˆé€šå¸¸ã¯ç›´æ¥ä½¿ã‚ãªã„ï¼‰
import api from '@/plugins/axios';
const response = await api.get('/some-endpoint/');

*******************************************************************************
4. èªè¨¼ã‚¹ãƒˆã‚¢
auth.js (Pinia Store)

import { useAuthStore } from '@/stores/auth';

const auth = useAuthStore();

// ä½¿ç”¨ä¾‹
await auth.loginSession('12345', 'password');
await auth.logout();
await auth.fetchUser(); // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å†å–å¾—
await auth.initialize(); // åˆå›åˆæœŸåŒ–ï¼ˆã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ï¼‰
await auth.validateSession(); // ã‚»ãƒƒã‚·ãƒ§ãƒ³æœ‰åŠ¹æ€§ãƒã‚§ãƒƒã‚¯

// çŠ¶æ…‹å‚ç…§
console.log(auth.user); // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
console.log(auth.isAuthenticated); // ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹
console.log(auth.loading); // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ä¸­

é‡è¦: persistã§userã‚’æ°¸ç¶šåŒ–ï¼ˆãƒªãƒ­ãƒ¼ãƒ‰æ™‚ã‚‚ä¿æŒï¼‰

*******************************************************************************
5. ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚¬ãƒ¼ãƒ‰
auth-guard.js - èªè¨¼ãƒã‚§ãƒƒã‚¯

// ãƒ«ãƒ¼ãƒˆå®šç¾©ã§ã®ä½¿ç”¨
{
    path: '/dashboard',
    meta: { requiresAuth: true } // â­ ãƒ­ã‚°ã‚¤ãƒ³å¿…é ˆ
}

{
    path: '/login',
    meta: { hideForAuth: true } // â­ ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã¯ãƒ›ãƒ¼ãƒ ã¸
}

*******************************************************************************
admin-guard.js - ç®¡ç†è€…æ¨©é™ãƒã‚§ãƒƒã‚¯

// ãƒ«ãƒ¼ãƒˆå®šç¾©ã§ã®ä½¿ç”¨
{
    path: '/admin',
    meta: { 
        requiresAuth: true,
        requiresAdmin: true // â­ ç®¡ç†è€…ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
    }
}

å‡¦ç†ã®æµã‚Œ:

beforeEachã§auth-guardå®Ÿè¡Œ â†’ æœªãƒ­ã‚°ã‚¤ãƒ³ãªã‚‰/auth/loginã¸
æ¬¡ã«admin-guardå®Ÿè¡Œ â†’ éç®¡ç†è€…ãªã‚‰/ã¸ï¼ˆunauthorized=adminã‚¯ã‚¨ãƒªä»˜ãï¼‰

*******************************************************************************
6. é€šçŸ¥ã‚¹ãƒˆã‚¢
notification.js (Pinia Store)

import { useNotificationStore } from '@/stores/notification';

const notification = useNotificationStore();

// ä½¿ç”¨ä¾‹
notification.success('ä¿å­˜ã—ã¾ã—ãŸ'); // 5ç§’è¡¨ç¤º
notification.error('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ', 7000); // 7ç§’è¡¨ç¤º
notification.warning('æ³¨æ„ã—ã¦ãã ã•ã„', 6000);
notification.info('ãŠçŸ¥ã‚‰ã›ã§ã™');
notification.close(); // æ‰‹å‹•ã§é–‰ã˜ã‚‹

*******************************************************************************
7. UIã‚¹ãƒˆã‚¢
ui.js (Pinia Store)

import { useUiStore } from '@/stores/ui';

const ui = useUiStore();

// ä½¿ç”¨ä¾‹
ui.toggleDrawer(); // ã‚µã‚¤ãƒ‰ãƒãƒ¼é–‹é–‰
ui.toggleRail(); // ãƒ¬ãƒ¼ãƒ«ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆï¼ˆPCæ™‚ã®ã¿ï¼‰

// çŠ¶æ…‹å‚ç…§
console.log(ui.drawer); // ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®é–‹é–‰çŠ¶æ…‹
console.log(ui.rail); // ãƒ¬ãƒ¼ãƒ«ãƒ¢ãƒ¼ãƒ‰ï¼ˆã‚¢ã‚¤ã‚³ãƒ³ã®ã¿è¡¨ç¤ºï¼‰
console.log(ui.isDesktop); // PCç”»é¢ã‹ã©ã†ã‹

ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ:

PC: drawer=true, rail=trueï¼ˆãƒŸãƒ‹ãƒ¢ãƒ¼ãƒ‰ï¼‰
ãƒ¢ãƒã‚¤ãƒ«: drawer=false, railã¯ç„¡è¦–ï¼ˆä¸€æ™‚çš„ã«é–‹é–‰ï¼‰

*******************************************************************************
8. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
validation.js

import { createValidationRules } from '@/utils/validation';

const rules = createValidationRules();

// ä½¿ç”¨ä¾‹ï¼ˆv-text-fieldï¼‰
<v-text-field
    :rules="[
        rules.required('username'),
        rules.minLength('username', 3),
        rules.maxLength('username', 20)
    ]"
/>

// ã‚«ã‚¹ã‚¿ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
<v-text-field
    :rules="[
        rules.custom(
            (value) => /^[0-9]+$/.test(value),
            'form.validation.employeeIdFormat'
        )
    ]"
/>

*******************************************************************************
9. i18nï¼ˆå¤šè¨€èªå¯¾å¿œï¼‰
i18n.js - è‡ªå‹•è¨€èªæ¤œå‡º + ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯

import { useI18n } from 'vue-i18n';

const { t, locale } = useI18n();

// ä½¿ç”¨ä¾‹
<h1>{{ t('pages.users.title') }}</h1> // "ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†"
<v-btn>{{ t('actions.save') }}</v-btn> // "ä¿å­˜"

// è¨€èªåˆ‡ã‚Šæ›¿ãˆ
locale.value = 'en'; // è‹±èªã«å¤‰æ›´
locale.value = 'ja'; // æ—¥æœ¬èªã«å¤‰æ›´

// ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä»˜ãç¿»è¨³
t('form.validation.maxLength', { field: 'ãƒ¦ãƒ¼ã‚¶ãƒ¼å', max: 20 })
// â†’ "ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¯20æ–‡å­—ä»¥å†…ã§å…¥åŠ›ã—ã¦ãã ã•ã„"

ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯è¨­å®š:

è‹±èªã®ç¿»è¨³ãŒãªã„å ´åˆã€æ—¥æœ¬èªã‚’è¡¨ç¤º
é–‹ç™ºæ™‚ã®ã¿è­¦å‘Šã‚’è¡¨ç¤ºï¼ˆsilentFallbackWarn: falseï¼‰

*******************************************************************************
10. Vuetifyè¨­å®š
vuetify.js - Material Symbolså¯¾å¿œ

// ã‚¢ã‚¤ã‚³ãƒ³ã®ä½¿ã„æ–¹
<v-icon>home</v-icon> // Material Symbols
<v-icon>{{ ICONS.nav.home }}</v-icon> // å®šæ•°çµŒç”±

// å†…éƒ¨ã§è‡ªå‹•å¤‰æ›ã•ã‚Œã‚‹ã‚¢ã‚¤ã‚³ãƒ³
// - v-pagination: prev/next
// - v-data-table: sortAsc/sortDesc/expand
// - v-checkbox: checkboxOn/checkboxOff
// - v-radio: radioOn/radioOff

ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¤ã‚³ãƒ³ã‚»ãƒƒãƒˆ:

materialSymbols.componentã§<span class="material-symbols-outlined">ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
Vuetifyã®å†…éƒ¨ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã€ãƒ†ãƒ¼ãƒ–ãƒ«ãªã©ï¼‰ã‚‚è‡ªå‹•å¤‰æ›

******************************************************************************************************

1. ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ (Login.vue)
ç‰¹å¾´

ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ä¸­å¤®é…ç½®ã®ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚¹ã‚¿ã‚¤ãƒ«
ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³/ã‚¢ã‚¦ãƒˆã®ã‚¹ãƒ ãƒ¼ã‚ºãªé·ç§»
ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚¹ãƒ©ã‚¤ãƒ‰ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
ä½¿ã„æ–¹

<script setup>
// ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã‚’å–å¾—
const employeeIdRules = createRules.loginEmployeeId();
const passwordRules = createRules.loginPassword();

// ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
async function onSubmit() {
    const { valid } = await form.value.validate();
    if (!valid) return;
    
    // ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†
    const result = await auth.loginSession(employeeId.value, password.value);
    
    if (result.success) {
        // ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆã—ã¦ã‹ã‚‰é·ç§»
        isVisible.value = false;
        setTimeout(() => router.push(redirect), 300);
    }
}
</script>

ãƒã‚¤ãƒ³ãƒˆ:

form.value.validate()ã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
ã‚¨ãƒ©ãƒ¼ã¯messages.auth.invalidCredentialsã§çµ±ä¸€
é·ç§»å‰ã«ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆï¼ˆ300mså¾…æ©Ÿï¼‰

*******************************************************************************
2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ (UserList.vue)
ç‰¹å¾´

v-data-table-serverã§ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³
æ¤œç´¢ãƒ‡ãƒã‚¦ãƒ³ã‚¹ï¼ˆ500msï¼‰
è¡Œã‚¯ãƒªãƒƒã‚¯ã§è©³ç´°ç”»é¢ã¸é·ç§»
URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒæœŸï¼ˆæ¤œç´¢ãƒ»ãƒšãƒ¼ã‚¸ãƒ»ã‚½ãƒ¼ãƒˆï¼‰

ä½¿ã„æ–¹
<script setup>
// ãƒ‡ãƒã‚¦ãƒ³ã‚¹ä»˜ãæ¤œç´¢
function handleSearchInput(value) {
    searching.value = true;
    
    if (searchTimer) clearTimeout(searchTimer);
    
    searchTimer = setTimeout(() => {
        currentPage.value = 1; // ãƒšãƒ¼ã‚¸ãƒªã‚»ãƒƒãƒˆ
        fetchUsers();
        updateURLParams(); // URLåŒæœŸ
    }, 500);
}

// ãƒ†ãƒ¼ãƒ–ãƒ«ã‚ªãƒ—ã‚·ãƒ§ãƒ³æ›´æ–°ï¼ˆãƒšãƒ¼ã‚¸ãƒ»ã‚½ãƒ¼ãƒˆå¤‰æ›´æ™‚ï¼‰
function handleOptionsUpdate(options) {
    currentPage.value = options.page;
    itemsPerPage.value = options.itemsPerPage;
    sortBy.value = options.sortBy;
    
    fetchUsers();
    updateURLParams();
}

// è¡Œã‚¯ãƒªãƒƒã‚¯ã§è©³ç´°ã¸
function handleRowClick(event, { item }) {
    router.push(routes.USER_DETAIL.replace(':id', item.id));
}
</script>

URLåŒæœŸã®ä¾‹:
/users?search=test&page=2&sort=username&order=asc

*******************************************************************************
3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ (UserCreate.vue)
ä½¿ã„æ–¹

<script setup>
// ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿
const formData = ref({
    username: '',
    employee_id: '',
    password: '',
    is_admin: false,
});

// ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«
const usernameRules = createRules.username();
const employeeIdRules = [
    (v) => !!v || t('form.validation.required', { field: t('form.fields.employeeId') }),
    (v) => /^\d{1,10}$/.test(v) || t('form.validation.employeeIdFormat'),
];
const passwordRules = createRules.newPassword();

// é€ä¿¡å‡¦ç†
async function submitForm() {
    const { valid } = await form.value.validate();
    if (!valid) return;
    
    try {
        await usersAPI.create(formData.value);
        notification.success(t('pages.users.createSuccess', { username: formData.value.username }));
        router.replace(routes.USERS);
    } catch (error) {
        notification.error(error.response?.data?.detail || t('pages.users.createError'));
    }
}
</script>

*******************************************************************************
4. ãƒ¦ãƒ¼ã‚¶ãƒ¼æ›´æ–° (UserUpdate.vue)
ç‰¹å¾´

ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã§åˆ¶å¾¡ï¼‰
ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç¢ºèªæ¬„ä»˜ã
v-expand-transitionã§ã‚¹ãƒ ãƒ¼ã‚ºãªå±•é–‹

ä½¿ã„æ–¹
<script setup>
const changePassword = ref(false);
const passwordConfirm = ref('');

// ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ«ãƒ¼ãƒ«ï¼ˆå¤‰æ›´æ™‚ã®ã¿æœ‰åŠ¹ï¼‰
const passwordRules = computed(() => {
    if (!changePassword.value) return [];
    return [
        (v) => !!v || 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',
        (v) => v.length >= 8 || 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯8æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„',
    ];
});

const passwordConfirmRules = computed(() => {
    if (!changePassword.value) return [];
    return [
        (v) => !!v || 'ç¢ºèªç”¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',
        (v) => v === formData.value.password || 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒä¸€è‡´ã—ã¾ã›ã‚“',
    ];
});

// é€ä¿¡å‡¦ç†
async function submitForm() {
    const updateData = {
        username: formData.value.username,
        employee_id: formData.value.employee_id,
        is_admin: formData.value.is_admin,
        is_active: formData.value.is_active,
    };
    
    // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´ãŒé¸æŠã•ã‚Œã¦ã„ã‚‹å ´åˆã®ã¿é€ä¿¡
    if (changePassword.value && formData.value.password) {
        updateData.password = formData.value.password;
    }
    
    await usersAPI.update(userId.value, updateData);
}
</script>

*******************************************************************************
5. ãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤ (UserDelete.vue)
ç‰¹å¾´

ConfirmDialogã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä½¿ç”¨
æœ€å¾Œã®ç®¡ç†è€…ã¯å‰Šé™¤ä¸å¯

ä½¿ã„æ–¹
<script setup>
const showConfirmDialog = ref(false);

// æœ€å¾Œã®ç®¡ç†è€…ãƒã‚§ãƒƒã‚¯
const isLastAdmin = computed(() => {
    if (!user.value.is_admin) return false;
    const adminCount = allUsers.value.filter(u => u.is_admin && u.is_active).length;
    return adminCount === 1;
});

// å‰Šé™¤å‡¦ç†
async function deleteUser() {
    if (isLastAdmin.value) return;
    
    deleting.value = true;
    try {
        await usersAPI.delete(userId.value);
        notification.success(t('pages.users.deleteSuccess', { username: user.value.username }));
        
        showConfirmDialog.value = false;
        router.replace(routes.USERS);
    } catch (error) {
        notification.error(error.response?.data?.detail || t('pages.users.deleteError'));
    } finally {
        deleting.value = false;
    }
}
</script>

<template>
    <!-- å‰Šé™¤ãƒœã‚¿ãƒ³ -->
    <v-btn color="error" :disabled="isLastAdmin" @click="showConfirmDialog = true">
        {{ t('common.delete') }}
    </v-btn>
    
    <!-- ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚° -->
    <ConfirmDialog
        v-model="showConfirmDialog"
        :title="t('pages.userDelete.confirmTitle')"
        :message="t('pages.userDelete.confirmMessage', { username: user.username })"
        confirm-color="error"
        :loading="deleting"
        @confirm="deleteUser"
    >
        <template #content>
            <v-alert type="error" variant="tonal">ã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“</v-alert>
        </template>
    </ConfirmDialog>
</template>

*******************************************************************************
6. ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´° (UserDetail.vue)
ä½¿ã„æ–¹
<script setup>
// ä¸¦åˆ—å–å¾—ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ± + å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ï¼‰
async function fetchUser() {
    const [userResponse, usersResponse] = await Promise.all([
        usersAPI.get(userId.value),
        usersAPI.list(),
    ]);
    user.value = userResponse.data;
    allUsers.value = usersResponse.data.results || usersResponse.data;
}

// æœ€å¾Œã®ç®¡ç†è€…ãƒã‚§ãƒƒã‚¯
const isLastAdmin = computed(() => {
    if (!user.value.is_admin) return false;
    const adminCount = allUsers.value.filter(u => u.is_admin && u.is_active).length;
    return adminCount === 1;
});
</script>

*******************************************************************************
7. ãƒ›ãƒ¼ãƒ ç”»é¢ (Home.vue)
ç‰¹å¾´

MenuCardGridã§å‹•çš„ãªãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨ç¤º
æ¨©é™ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼ˆç®¡ç†è€…å°‚ç”¨ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼‰
æ¨©é™ã‚¨ãƒ©ãƒ¼é€šçŸ¥ï¼ˆunauthorized=adminã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¤œå‡ºï¼‰

ä½¿ã„æ–¹
<script setup>
// ãƒã‚¦ãƒ³ãƒˆæ™‚ã«æ¨©é™ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯
onMounted(() => {
    if (route.query.unauthorized === 'admin') {
        notification.warning('ã“ã®æ©Ÿèƒ½ã¯ç®¡ç†è€…ã®ã¿åˆ©ç”¨ã§ãã¾ã™', 5000);
        router.replace({ path: routes.HOME, query: {} }); // URLã‚¯ãƒªãƒ¼ãƒ³
    }
});

// ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚¢ã‚¤ãƒ†ãƒ ã®å®šç¾©
const menuItems = [
    {
        icon: ICONS.nav.management,
        title: 'ç®¡ç†è€…ãƒ¡ãƒ‹ãƒ¥ãƒ¼',
        to: routes.ADMIN,
        color: 'primary',
        requiresAdmin: true, // â­ ç®¡ç†è€…å°‚ç”¨
    },
    // ...
];

// æ¨©é™ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
const filteredMenuItems = computed(() => {
    return menuItems.filter(item => {
        if (item.requiresAdmin) {
            return isAdmin.value;
        }
        return true;
    });
});
</script>

*******************************************************************************
8. App.vue - åˆæœŸåŒ–åˆ¶å¾¡
ç‰¹å¾´

ãƒ•ã‚©ãƒ³ãƒˆãƒ»ã‚¢ã‚¤ã‚³ãƒ³èª­ã¿è¾¼ã¿å¾…æ©Ÿ
ãƒãƒ©ã¤ãé˜²æ­¢ï¼ˆç™½ç”»é¢ â†’ ä¸€æ°—è¡¨ç¤ºï¼‰
main.jsã¨é€£æºã—ãŸäºŒæ®µéšåˆæœŸåŒ–

ä½¿ã„æ–¹
<script setup>
const appReady = ref(false);

onMounted(async () => {
    await Promise.all([
        // èªè¨¼åˆæœŸåŒ–ï¼ˆmain.jsã§æ¸ˆã‚“ã§ã„ã‚Œã°ã‚¹ã‚­ãƒƒãƒ—ï¼‰
        auth.initialized ? Promise.resolve() : auth.initialize(),
        // ãƒ•ã‚©ãƒ³ãƒˆãƒ»ã‚¢ã‚¤ã‚³ãƒ³èª­ã¿è¾¼ã¿
        waitForFontsAndIcons(),
        // æœ€å°è¡¨ç¤ºæ™‚é–“ï¼ˆ100msï¼‰
        new Promise(resolve => setTimeout(resolve, 100)),
    ]);
    
    await nextTick(); // DOMæ›´æ–°å¾…æ©Ÿ
    
    appReady.value = true; // ä¸€æ°—ã«è¡¨ç¤º
});
</script>

<template>
    <!-- æº–å‚™å®Œäº†å¾Œã«è¡¨ç¤º -->
    <div v-show="appReady" :class="['app-content', { 'fade-in': appReady }]">
        <NavBar v-if="auth.user" />
        <SideBar v-if="auth.user" />
        <v-main><router-view /></v-main>
    </div>
    
    <!-- æº–å‚™ä¸­ã¯ç™½ç”»é¢ -->
    <div v-show="!appReady" class="loading-screen"></div>
</template>

*******************************************************************************
9. main.js - äº‹å‰åˆæœŸåŒ–
ä½¿ã„æ–¹
const initializeApp = async () => {
    try {
        const authStore = useAuthStore();
        await authStore.initialize(); // â­ äº‹å‰ã«èªè¨¼çŠ¶æ…‹å–å¾—
    } catch (error) {
        console.error('äº‹å‰åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
        // ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã‚‚ãƒã‚¦ãƒ³ãƒˆã™ã‚‹
    } finally {
        app.mount('#app');
    }
};

initializeApp();

å‡¦ç†ã®æµã‚Œ:

main.js: authStore.initialize()å®Ÿè¡Œï¼ˆæ°¸ç¶šåŒ–ãƒ‡ãƒ¼ã‚¿ç¢ºèª â†’ ã‚µãƒ¼ãƒãƒ¼åŒæœŸï¼‰
App.vue: auth.initializedãŒtrueãªã‚‰å†å®Ÿè¡Œã‚¹ã‚­ãƒƒãƒ—
ãƒ•ã‚©ãƒ³ãƒˆãƒ»ã‚¢ã‚¤ã‚³ãƒ³èª­ã¿è¾¼ã¿å®Œäº†
ä¸€æ°—ã«ç”»é¢è¡¨ç¤º

********************************************************************************

composables/useApiError.js

ğŸ¯ useApiError ã¨ã¯ï¼ŸAPIã‚¨ãƒ©ãƒ¼ã‚’è‡ªå‹•çš„ã«è§£æã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«åˆ†ã‹ã‚Šã‚„ã™ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹Composable

ğŸ“– åŸºæœ¬çš„ãªä½¿ã„æ–¹1. ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
import { useApiError } from '@/composables/useApiError';

const { handleApiError, showSuccess } = useApiError();

2. APIå‘¼ã³å‡ºã—æ™‚ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ‘ã‚¿ãƒ¼ãƒ³A: åŸºæœ¬å½¢ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚ã‚Šï¼‰
async function submitForm() {
    try {
        await usersAPI.create(formData.value);
        
        // æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        showSuccess('pages.users.createSuccess', { username: formData.value.username });
        
        router.push(routes.USERS);
    } catch (error) {
        // â­ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼ˆ1è¡Œã§å®Œçµï¼‰
        handleApiError(error, 'pages.users.createError');
    }
}

å‹•ä½œ:

ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰è©³ç´°ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¿”ã£ã¦ãã‚‹ â†’ ãã‚Œã‚’è¡¨ç¤º
ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒãªã„ â†’ ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸã€ã‚’è¡¨ç¤º

-------------------------------------------------------
ãƒ‘ã‚¿ãƒ¼ãƒ³B: ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãªã—

async function fetchUsers() {
    try {
        const response = await usersAPI.list();
        users.value = response.data.results;
    } catch (error) {
        // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãªã—ï¼ˆã‚µãƒ¼ãƒãƒ¼ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿è¡¨ç¤ºï¼‰
        handleApiError(error);
    }
}

--------------------------------------------------------
ãƒ‘ã‚¿ãƒ¼ãƒ³C: ã‚«ã‚¹ã‚¿ãƒ è¡¨ç¤ºæ™‚é–“
async function deleteUser() {
    try {
        await usersAPI.delete(userId.value);
        showSuccess('pages.users.deleteSuccess', { username: user.value.username });
    } catch (error) {
        // 10ç§’é–“è¡¨ç¤ºï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯7ç§’ï¼‰
        handleApiError(error, 'pages.users.deleteError', 10000);
    }
}

---------------------------------------------------------
3. æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¡¨ç¤º
åŸºæœ¬å½¢
// i18nã®ã‚­ãƒ¼ã‚’æŒ‡å®š
showSuccess('pages.users.createSuccess', { username: 'yamada' });
// â†’ ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œyamadaã€ã‚’ä½œæˆã—ã¾ã—ãŸã€


ã‚«ã‚¹ã‚¿ãƒ è¡¨ç¤ºæ™‚é–“
// 3ç§’é–“è¡¨ç¤ºï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯5ç§’ï¼‰
showSuccess('pages.users.updateSuccess', { username: 'yamada' }, 3000);


4. è­¦å‘Šãƒ»æƒ…å ±ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
// è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆ6ç§’è¡¨ç¤ºï¼‰
showWarning('pages.users.lastAdminWarning');

// æƒ…å ±ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆ5ç§’è¡¨ç¤ºï¼‰
showInfo('pages.users.accountLocked');


ğŸ” ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è§£æãƒ­ã‚¸ãƒƒã‚¯
handleApiError() ã¯ä»¥ä¸‹ã®å„ªå…ˆé †ä½ã§ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æŠ½å‡ºã—ã¾ã™ï¼š

1. error.response.data.detail        ï¼ˆDRFæ¨™æº–ï¼‰
   â†“
2. error.response.data.error         ï¼ˆã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼‰
   â†“
3. error.response.data[field_name]   ï¼ˆSerializer Validationï¼‰
   ä¾‹: employee_id, username, email, password
   â†“
4. error.response.data.non_field_errors  ï¼ˆãƒ•ã‚©ãƒ¼ãƒ å…¨ä½“ã®ã‚¨ãƒ©ãƒ¼ï¼‰
   â†“
5. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼
   â†’ "ã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã§ãã¾ã›ã‚“ã€‚ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚"
   â†“
6. ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆå¼•æ•°ã§æŒ‡å®šã—ãŸi18nã‚­ãƒ¼ï¼‰
   â†“
7. æœ€çµ‚ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
   â†’ "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ"


ğŸ¯ å®Ÿéš›ã®ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹
ä¾‹1: ç¤¾å“¡ç•ªå·ã®é‡è¤‡ã‚¨ãƒ©ãƒ¼
ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹:
{
  "employee_id": ["ç¤¾å“¡ç•ªå·ã€ŒE001ã€ã¯æ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚åˆ¥ã®ç¤¾å“¡ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"]
}

ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ã®å‡¦ç†:
handleApiError(error, 'pages.users.createError');
// â†’ é€šçŸ¥: "ç¤¾å“¡ç•ªå·ã€ŒE001ã€ã¯æ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚åˆ¥ã®ç¤¾å“¡ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"

-------------------------------------------------
ä¾‹2: æœ€å¾Œã®ç®¡ç†è€…å‰Šé™¤ã‚¨ãƒ©ãƒ¼
ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹:
{
  "detail": "ç®¡ç†è€…ã¯æœ€ä½1äººå¿…è¦ã§ã™ã€‚æœ€å¾Œã®ç®¡ç†è€…ã‚’å‰Šé™¤ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚"
}

ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ã®å‡¦ç†:
handleApiError(error, 'pages.users.deleteError');
// â†’ é€šçŸ¥: "ç®¡ç†è€…ã¯æœ€ä½1äººå¿…è¦ã§ã™ã€‚æœ€å¾Œã®ç®¡ç†è€…ã‚’å‰Šé™¤ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚"

-------------------------------------------------
ä¾‹3: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼
ã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã§ããªã„:

handleApiError(error, 'pages.users.fetchError');
// â†’ é€šçŸ¥: "ã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã§ãã¾ã›ã‚“ã€‚ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚"

-------------------------------------------------
ä¾‹4: ã‚µãƒ¼ãƒãƒ¼ãŒã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿”ã•ãªã„
ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹:
{
  "status": 500
}

-------------------------------------------------
ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ã®å‡¦ç†:
handleApiError(error, 'pages.users.createError');
// â†’ é€šçŸ¥: "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ"ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰



********************************************************************************
è£œè¶³ï¼š
ğŸ¯ theme.js ã¨ useDesignSystem.js ã®å½¹å‰²åˆ†æ‹…theme.js ã®å½¹å‰²ï¼šãƒ‡ãƒ¼ã‚¿ã®å®šç¾©

é™çš„ãªå®šæ•°ã®é›†ç´„å ´æ‰€
è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦æ©Ÿèƒ½
Single Source of Truthï¼ˆä¿¡é ¼ã§ãã‚‹å”¯ä¸€ã®æƒ…å ±æºï¼‰
useDesignSystem.js ã®å½¹å‰²ï¼šãƒ‡ãƒ¼ã‚¿ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹å±¤

Vuetifyã®ãƒ†ãƒ¼ãƒã¨é€£æº
ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤ã‚’æä¾›
ä¾¿åˆ©ãªãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã‚’æä¾›

ğŸ”„ ãƒ‡ãƒ¼ã‚¿ã®æµã‚Œ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   theme.js      â”‚  â­ ãƒ‡ãƒ¼ã‚¿ã®å®šç¾©ï¼ˆé™çš„ï¼‰
â”‚  - COLORS       â”‚
â”‚  - ICON_SIZES   â”‚
â”‚  - SPACING      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ import
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ vuetify.js      â”‚  â­ Vuetifyã«è¨­å®šã‚’æ³¨å…¥
â”‚ (plugins)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ useTheme()
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚useDesignSystem  â”‚  â­ ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¢ã‚¯ã‚»ã‚¹å±¤
â”‚  - colors       â”‚      + ä¾¿åˆ©ãªãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
â”‚  - getSize()    â”‚
â”‚  - getIcon()    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ ä½¿ç”¨
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Vue Components  â”‚  â­ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ä½¿ç”¨
â”‚  (*.vue)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

--------------------------------------------------------------
ä½¿ã„åˆ†ã‘
// âœ… Vueã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…
const { colors, getSize } = useDesignSystem();
const iconSize = getSize('md');

// âœ… Vuetifyè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆvuetify.jsï¼‰
import { COLORS, ELEVATION } from '@/constants/theme';
const primary = COLORS.brand.primary;

// âœ… ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ï¼ˆVueå¤–ï¼‰
import { ICON_SIZES, SPACING } from '@/constants/theme';
const padding = SPACING.lg;

// âŒ Vueã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§å®šæ•°ã‚’ç›´æ¥importï¼ˆéæ¨å¥¨ï¼‰
// import { COLORS } from '@/constants/theme'; // ã“ã‚Œã¯éæ¨å¥¨
// const primary = COLORS.brand.primary; // useDesignSystem()ã‚’æ¨å¥¨


ãªãœä¸¡æ–¹å¿…è¦ï¼Ÿ

theme.js: ãƒ‡ãƒ¼ã‚¿ã®å®šç¾©å ´æ‰€ã¨ã—ã¦å¿…é ˆ

Vuetifyè¨­å®šã§ä½¿ã†
ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ã§ä½¿ã†
å…¨ã¦ã®å ´æ‰€ã‹ã‚‰å‚ç…§ã§ãã‚‹


useDesignSystem.js: Vueã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã®ä¾¿åˆ©ãªã‚¢ã‚¯ã‚»ã‚¹å±¤

Vuetifyã®ãƒ†ãƒ¼ãƒã¨é€£æº
ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«å¯¾å¿œ
ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã§ç°¡æ½”ã«



çµè«–: theme.jsã¯ãƒ‡ãƒ¼ã‚¿ã®å€‰åº«ã€useDesignSystemã¯ä¾¿åˆ©ãªçª“å£ã§ã™(Â´ãƒ»Ï‰ãƒ»ï½€)ï¼
********************************************************************************

frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ auth.js              âœ… ä½¿ç”¨ä¸­
â”‚   â”‚   â””â”€â”€ users.js             âœ… ä½¿ç”¨ä¸­
â”‚   â”‚
â”‚   â”œâ”€â”€ assets/
â”‚   â”‚   â””â”€â”€ style/
â”‚   â”‚       â””â”€â”€ main.scss        âœ… ä½¿ç”¨ä¸­
â”‚   â”‚
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ ConfirmDialog.vue    âœ… ä½¿ç”¨ä¸­ï¼ˆUserDelete.vueï¼‰
â”‚   â”‚   â”œâ”€â”€ Header.vue           âœ… ä½¿ç”¨ä¸­ï¼ˆå…¨ãƒšãƒ¼ã‚¸ï¼‰
â”‚   â”‚   â”œâ”€â”€ MenuCard.vue         âœ… ä½¿ç”¨ä¸­ï¼ˆMenuCardGridï¼‰
â”‚   â”‚   â”œâ”€â”€ MenuCardGrid.vue     âœ… ä½¿ç”¨ä¸­ï¼ˆHome.vue, AdminMenu.vueï¼‰
â”‚   â”‚   â”œâ”€â”€ NavBar.vue           âœ… ä½¿ç”¨ä¸­ï¼ˆApp.vueï¼‰
â”‚   â”‚   â”œâ”€â”€ Notification.vue     âœ… ä½¿ç”¨ä¸­ï¼ˆApp.vueï¼‰
â”‚   â”‚   â””â”€â”€ SideBar.vue          âœ… ä½¿ç”¨ä¸­ï¼ˆApp.vueï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ composables/
â”‚   â”‚   â”œâ”€â”€ useApiError.js       âœ… ä½¿ç”¨ä¸­ï¼ˆå…¨CRUDç”»é¢ï¼‰
â”‚   â”‚   â”œâ”€â”€ useDesignSystem.js   âœ… ä½¿ç”¨ä¸­ï¼ˆå…¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‰
â”‚   â”‚   â”œâ”€â”€ usePermissions.js    âœ… ä½¿ç”¨ä¸­ï¼ˆSideBar.vue, Home.vueï¼‰
â”‚   â”‚   â””â”€â”€ useValidation.js     âœ… ä½¿ç”¨ä¸­ï¼ˆLogin.vue, UserCreate.vueç­‰ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ constants/
â”‚   â”‚   â”œâ”€â”€ icons.js             âœ… ä½¿ç”¨ä¸­ï¼ˆå…¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‰
â”‚   â”‚   â”œâ”€â”€ messages.js          âœ… ä½¿ç”¨ä¸­ï¼ˆLogin.vueï¼‰
â”‚   â”‚   â”œâ”€â”€ routes.js            âœ… ä½¿ç”¨ä¸­ï¼ˆrouter, å…¨ç”»é¢ï¼‰
â”‚   â”‚   â””â”€â”€ theme.js             âœ… ä½¿ç”¨ä¸­ï¼ˆvuetify.js, useDesignSystemï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ locales/
â”‚   â”‚   â”œâ”€â”€ ja.json              âœ… ä½¿ç”¨ä¸­
â”‚   â”‚   â””â”€â”€ en.json              âœ… ä½¿ç”¨ä¸­
â”‚   â”‚
â”‚   â”œâ”€â”€ plugins/
â”‚   â”‚   â”œâ”€â”€ axios.js             âœ… ä½¿ç”¨ä¸­ï¼ˆAPIé€šä¿¡ï¼‰
â”‚   â”‚   â”œâ”€â”€ i18n.js              âœ… ä½¿ç”¨ä¸­ï¼ˆå¤šè¨€èªå¯¾å¿œï¼‰
â”‚   â”‚   â””â”€â”€ vuetify.js           âœ… ä½¿ç”¨ä¸­ï¼ˆUIï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ router/
â”‚   â”‚   â”œâ”€â”€ admin-guard.js       âœ… ä½¿ç”¨ä¸­ï¼ˆrouter/index.jsï¼‰
â”‚   â”‚   â”œâ”€â”€ auth-guard.js        âœ… ä½¿ç”¨ä¸­ï¼ˆrouter/index.jsï¼‰
â”‚   â”‚   â””â”€â”€ index.js             âœ… ä½¿ç”¨ä¸­ï¼ˆmain.jsï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ stores/
â”‚   â”‚   â”œâ”€â”€ auth.js              âœ… ä½¿ç”¨ä¸­ï¼ˆå…¨ç”»é¢ï¼‰
â”‚   â”‚   â”œâ”€â”€ notification.js      âœ… ä½¿ç”¨ä¸­ï¼ˆuseApiErrorçµŒç”±ï¼‰
â”‚   â”‚   â””â”€â”€ ui.js                âœ… ä½¿ç”¨ä¸­ï¼ˆNavBar, SideBarï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ validation.js        âœ… ä½¿ç”¨ä¸­ï¼ˆuseValidationçµŒç”±ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ views/
â”‚   â”‚   â”œâ”€â”€ admin/
â”‚   â”‚   â”‚   â””â”€â”€ AdminMenu.vue    âœ… ä½¿ç”¨ä¸­
â”‚   â”‚   â”œâ”€â”€ users/
â”‚   â”‚   â”‚   â”œâ”€â”€ UserList.vue     âœ… ä½¿ç”¨ä¸­
â”‚   â”‚   â”‚   â”œâ”€â”€ UserCreate.vue   âœ… ä½¿ç”¨ä¸­
â”‚   â”‚   â”‚   â”œâ”€â”€ UserDetail.vue   âœ… ä½¿ç”¨ä¸­
â”‚   â”‚   â”‚   â”œâ”€â”€ UserUpdate.vue   âœ… ä½¿ç”¨ä¸­
â”‚   â”‚   â”‚   â””â”€â”€ UserDelete.vue   âœ… ä½¿ç”¨ä¸­
â”‚   â”‚   â”œâ”€â”€ Home.vue             âœ… ä½¿ç”¨ä¸­
â”‚   â”‚   â”œâ”€â”€ Login.vue            âœ… ä½¿ç”¨ä¸­
â”‚   â”‚   â””â”€â”€ Settings.vue         âœ… ä½¿ç”¨ä¸­
â”‚   â”‚
â”‚   â”œâ”€â”€ App.vue                  âœ… ä½¿ç”¨ä¸­
â”‚   â””â”€â”€ main.js                  âœ… ä½¿ç”¨ä¸­
â”‚
â”œâ”€â”€ index.html                   âœ… ä½¿ç”¨ä¸­
â”œâ”€â”€ vite.config.js               âœ… ä½¿ç”¨ä¸­
â””â”€â”€ package.json                 âœ… ä½¿ç”¨ä¸­