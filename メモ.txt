ä½¿ã„æ–¹ã®ä¾‹
1. å‰Šé™¤ç¢ºèªï¼ˆç¾åœ¨ã®ä½¿ã„æ–¹ï¼‰

<ConfirmDialog
    v-model="showDialog"
    :title="t('modal.deleteConfirm.warning')"
    :message="t('modal.deleteConfirm.message', { username: user.username })"
    :confirm-text="t('buttons.delete')"
    confirm-color="error"
    :icon="ICONS.status.info"
    :confirm-icon="ICONS.buttons.delete"
    :loading="deleting"
    @confirm="deleteUser"
/>

2. ä¿å­˜ç¢ºèªï¼ˆå®šæ•°ç„¡ã—ã®å ´åˆï¼‰

<ConfirmDialog
    v-model="showSaveDialog"
    title="å¤‰æ›´ã‚’ä¿å­˜"
    message="ã“ã®å†…å®¹ã§ä¿å­˜ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
    confirm-text="ä¿å­˜"
    cancel-text="ã‚­ãƒ£ãƒ³ã‚»ãƒ«"
    confirm-color="primary"
    icon="save"
    confirm-icon="check"
    :loading="saving"
    @confirm="saveChanges"
/>



Propsä¸€è¦§

Props          å‹         ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ         èª¬æ˜          
modelValue     Boolean    false             ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤º/éè¡¨ç¤º
title          String     'ç¢ºèª'             ã‚¿ã‚¤ãƒˆãƒ«
message        String      å¿…é ˆ              ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
confirmText    String     'å®Ÿè¡Œ'             ç¢ºèªãƒœã‚¿ãƒ³ã®ãƒ†ã‚­ã‚¹ãƒˆ
cancelText     String     'ã‚­ãƒ£ãƒ³ã‚»ãƒ«'       ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒœã‚¿ãƒ³ã®ãƒ†ã‚­ã‚¹ãƒˆ
confirmColor   String     'error'           ç¢ºèªãƒœã‚¿ãƒ³ã®è‰²ï¼ˆerror/warning/primary/successï¼‰
icon           String     'alert-circle'    ãƒ˜ãƒƒãƒ€ãƒ¼ã‚¢ã‚¤ã‚³ãƒ³
confirmIcon    String     'check'           ç¢ºèªãƒœã‚¿ãƒ³ã®ã‚¢ã‚¤ã‚³ãƒ³
loading        Boolean     false            ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹

ã‚¤ãƒ™ãƒ³ãƒˆ
Event             èª¬æ˜
@confirm          ç¢ºèªãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯
@cancel           ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯

ã‚¹ãƒ­ãƒƒãƒˆ
Slot              èª¬æ˜
content           ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸‹ã«è¿½åŠ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æŒ¿å…¥

---------------------------------------------------------------------------------------------------

/**
 * é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ã®ä½¿ç”¨ã‚¬ã‚¤ãƒ‰
 * 
 * useApiError composable ã‚’ä½¿ç”¨ã—ã¦ã€ä¸€è²«æ€§ã®ã‚ã‚‹é€šçŸ¥ã‚’å®Ÿè£…ã—ã¾ã™
 */

// ============================================================================
// ğŸ“˜ åŸºæœ¬çš„ãªä½¿ã„æ–¹
// ============================================================================

// src/composables/useApiError.js ã‹ã‚‰ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
import { useApiError } from '@/composables/useApiError';
import { useNotificationStore } from '@/stores/notification';
import { useI18n } from 'vue-i18n';

const { handleApiError, showLoginSuccess, showCreateSuccess, showUpdateSuccess, showDeleteSuccess, showWarning, showInfo } = useApiError();

// ============================================================================
// ğŸ“Š ä½¿ç”¨ä¾‹ãƒ‘ã‚¿ãƒ¼ãƒ³é›†
// ============================================================================

// ------ ãƒ‘ã‚¿ãƒ¼ãƒ³1: ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸï¼ˆLogin.vue ã§ä½¿ç”¨ï¼‰ ------
async function handleLogin() {
    try {
        await auth.loginSession(employeeId, password);
        // âœ… ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸã¯ã€Œæƒ…å ±ã€ï¼ˆé’ï¼‰ã§è¡¨ç¤º
        showLoginSuccess('auth.loginSuccess', {}, 3000);
        // â†’ ç”»é¢é·ç§»
    } catch (error) {
        // âŒ ã‚¨ãƒ©ãƒ¼ã¯è‡ªå‹•æŠ½å‡º + ã€Œã‚¨ãƒ©ãƒ¼ã€ï¼ˆèµ¤ï¼‰ã§è¡¨ç¤º
        handleApiError(error, 'auth.loginFailed');
    }
}

// ------ ãƒ‘ã‚¿ãƒ¼ãƒ³2: ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæˆåŠŸï¼ˆNavBar.vue ã§ä½¿ç”¨ï¼‰ ------
async function handleLogout() {
    try {
        await auth.logout(false); // false: è‡ªå‹•ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆãªã—
        // âœ… ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæˆåŠŸã‚’é€šçŸ¥
        showInfo('auth.logoutSuccess', {}, 3000);
        // â†’ æ‰‹å‹•ã§ LOGIN ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
        router.push(routes.LOGIN);
    } catch (error) {
        console.error('Logout failed:', error);
        showWarning('auth.logoutFailed', {}, 5000);
    }
}

// ------ ãƒ‘ã‚¿ãƒ¼ãƒ³3: ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆæˆåŠŸï¼ˆUserCreate.vue ã§ä½¿ç”¨ï¼‰ ------
async function createUser() {
    try {
        const response = await usersAPI.create(formData);
        // âœ… ä½œæˆæˆåŠŸã¯ã€ŒæˆåŠŸã€ï¼ˆç·‘ï¼‰ã§è¡¨ç¤º
        showCreateSuccess('pages.users.create.success', {
            username: formData.username,
        });
        // â†’ ä¸€è¦§ç”»é¢ã¸é·ç§»
        router.replace(routes.USERS);
    } catch (error) {
        // âŒ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
        handleApiError(error, 'pages.users.create.error');
    }
}

// ------ ãƒ‘ã‚¿ãƒ¼ãƒ³4: ãƒ¦ãƒ¼ã‚¶ãƒ¼æ›´æ–°æˆåŠŸï¼ˆUserUpdate.vue ã§ä½¿ç”¨ï¼‰ ------
async function updateUser() {
    try {
        await usersAPI.update(userId, formData);
        showUpdateSuccess('pages.users.update.success');
        router.replace(routes.USERS);
    } catch (error) {
        handleApiError(error, 'pages.users.update.error');
    }
}

// ------ ãƒ‘ã‚¿ãƒ¼ãƒ³5: ãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤æˆåŠŸï¼ˆUserDelete.vue ã§ä½¿ç”¨ï¼‰ ------
async function deleteUser() {
    try {
        await usersAPI.delete(userId);
        showDeleteSuccess('pages.users.delete.success');
        router.replace(routes.USERS);
    } catch (error) {
        handleApiError(error, 'pages.users.delete.error');
    }
}

// ------ ãƒ‘ã‚¿ãƒ¼ãƒ³6: è­¦å‘Šé€šçŸ¥ï¼ˆHome.vue ã§ä½¿ç”¨ï¼‰ ------
onMounted(() => {
    if (route.query.unauthorized === 'admin') {
        // âš ï¸ æ¨©é™ä¸è¶³ã‚’è­¦å‘Š
        showWarning('notifications.unauthorized.admin', {}, 5000);
        router.replace({ path: routes.HOME, query: {} });
    }
});

// ------ ãƒ‘ã‚¿ãƒ¼ãƒ³7: æƒ…å ±é€šçŸ¥ï¼ˆæ±ç”¨ï¼‰ ------
async function someAction() {
    try {
        // ... ä½•ã‹å®Ÿè¡Œ
        showInfo('notifications.info.actionCompleted', {}, 4000);
    } catch (error) {
        handleApiError(error);
    }
}

// ============================================================================
// ğŸ“‹ é–¢æ•°ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹
// ============================================================================

/**
 * handleApiError(error, fallbackMessageKey, duration)
 * 
 * APIã‚¨ãƒ©ãƒ¼ã‚’è‡ªå‹•çš„ã«å‡¦ç†ã—ã¦é€šçŸ¥ã‚’è¡¨ç¤ºã—ã¾ã™
 * 
 * @param {Error} error - APIã‹ã‚‰è¿”ã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
 * @param {string} [fallbackMessageKey] - i18nã‚­ãƒ¼ï¼ˆã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒãªã„å ´åˆã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
 * @param {number} [duration=7000] - é€šçŸ¥è¡¨ç¤ºæ™‚é–“ï¼ˆmsï¼‰
 * 
 * ä½¿ã„æ–¹:
 *   handleApiError(error) â†’ ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è‡ªå‹•æŠ½å‡º
 *   handleApiError(error, 'pages.users.create.error') â†’ ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æŒ‡å®š
 *   handleApiError(error, 'messages.error', 10000) â†’ è¡¨ç¤ºæ™‚é–“ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
 */

/**
 * showLoginSuccess(messageKey, params, duration)
 * ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸï¼ˆé’ã®æƒ…å ±é€šçŸ¥ï¼‰
 * 
 * @param {string} messageKey - i18nã‚­ãƒ¼ï¼ˆä¾‹: 'auth.loginSuccess'ï¼‰
 * @param {object} [params={}] - i18nãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
 * @param {number} [duration=3000] - è¡¨ç¤ºæ™‚é–“ï¼ˆmsï¼‰
 */

/**
 * showCreateSuccess(messageKey, params, duration)
 * ä½œæˆæˆåŠŸï¼ˆç·‘ã®æˆåŠŸé€šçŸ¥ï¼‰
 */

/**
 * showUpdateSuccess(messageKey, params, duration)
 * æ›´æ–°æˆåŠŸï¼ˆç·‘ã®æˆåŠŸé€šçŸ¥ï¼‰
 */

/**
 * showDeleteSuccess(messageKey, params, duration)
 * å‰Šé™¤æˆåŠŸï¼ˆç·‘ã®æˆåŠŸé€šçŸ¥ï¼‰
 */

/**
 * showWarning(messageKey, params, duration)
 * è­¦å‘Šï¼ˆã‚ªãƒ¬ãƒ³ã‚¸ã®è­¦å‘Šé€šçŸ¥ï¼‰
 * ç”¨é€”: æ¨©é™ä¸è¶³ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³æœŸé™åˆ‡ã‚Œé–“è¿‘ã€éæ¨å¥¨æ“ä½œãªã©
 */

/**
 * showInfo(messageKey, params, duration)
 * æƒ…å ±ï¼ˆé’ã®æƒ…å ±é€šçŸ¥ï¼‰
 * ç”¨é€”: ä¸€èˆ¬çš„ãªæƒ…å ±ã€å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãªã©
 */

// ============================================================================
// ğŸ¨ é€šçŸ¥ã‚¿ã‚¤ãƒ—ã¨è¡¨ç¤ºè‰²ã®å¯¾å¿œ
// ============================================================================

/**
 * successï¼ˆç·‘ï¼‰ - showCreateSuccess, showUpdateSuccess, showDeleteSuccess
 *   â†’ ä½œæˆãƒ»æ›´æ–°ãƒ»å‰Šé™¤ãªã©ã®"è‚¯å®šçš„ãªå¤‰æ›´"ãŒæˆåŠŸã—ãŸã¨ã
 * 
 * errorï¼ˆèµ¤ï¼‰ - handleApiError
 *   â†’ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸã¨ãï¼ˆè‡ªå‹•çš„ã« error é€šçŸ¥ï¼‰
 * 
 * warningï¼ˆã‚ªãƒ¬ãƒ³ã‚¸ï¼‰ - showWarning
 *   â†’ è­¦å‘Šãƒ»æ³¨æ„ãŒå¿…è¦ãªã¨ãï¼ˆæ¨©é™ä¸è¶³ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³æœŸé™åˆ‡ã‚Œé–“è¿‘ãªã©ï¼‰
 * 
 * infoï¼ˆé’ï¼‰ - showLoginSuccess, showInfo
 *   â†’ æƒ…å ±æä¾›ãƒ»ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæˆåŠŸãƒ»ä¸€èˆ¬çš„ãªå®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
 */

// ============================================================================
// ğŸ“ i18nå®šç¾©ã®ä¾‹
// ============================================================================

/**
 * ja.json ã«ä»¥ä¸‹ã‚’è¿½åŠ :
 * 
 * {
 *   "auth": {
 *     "loginSuccess": "ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã—ãŸ",
 *     "loginFailed": "ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ",
 *     "logoutSuccess": "ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸ",
 *     "logoutFailed": "ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ"
 *   },
 *   "pages": {
 *     "users": {
 *       "create": {
 *         "success": "{username} ã‚’ä½œæˆã—ã¾ã—ãŸ",
 *         "error": "ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ"
 *       },
 *       "update": {
 *         "success": "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æ›´æ–°ã—ã¾ã—ãŸ",
 *         "error": "ãƒ¦ãƒ¼ã‚¶ãƒ¼æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ"
 *       },
 *       "delete": {
 *         "success": "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å‰Šé™¤ã—ã¾ã—ãŸ",
 *         "error": "ãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ"
 *       }
 *     }
 *   },
 *   "notifications": {
 *     "unauthorized": {
 *       "admin": "ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ã§ã™"
 *     },
 *     "error": {
 *       "network": "ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ",
 *       "unknown": "äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ"
 *     }
 *   }
 * }
 */